!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).slimdom={})}(this,(function(t){"use strict";class n{constructor(t,n,e,r){this.source=null,this.observer=t,this.node=n,this.options=e,this.source=r||null,r&&t.t.push(this)}collectInterestedObservers(t,n,e,r,o){if(this.node!==n&&!this.options.subtree)return;if("attributes"===t&&!this.options.attributes)return;if("characterData"===t&&!this.options.characterData)return;if("childList"===t&&!this.options.childList)return;let i=r.indexOf(this.observer);i<0&&(i=r.length,r.push(this.observer),o.push(void 0)),("attributes"===t&&this.options.attributeOldValue||"characterData"===t&&this.options.characterDataOldValue)&&(o[i]=e.oldValue)}}class e{constructor(t){this.o=[],this.i=t}register(t,e){const r=this.o;let o=!1;r.forEach((n=>{n.observer===t&&(o=!0,function(t){for(let n=t.observer.t.length-1;n>=0;--n){const e=t.observer.t[n];if(e.source!==t)return;e.node.o.removeTransientRegisteredObserver(e),t.observer.t.splice(n,1)}}(n),n.options=e)})),o||(this.o.push(new n(t,this.i,e)),t.u.push(this.i))}removeTransientRegisteredObserver(t){this.o.splice(this.o.indexOf(t),1)}removeForObserver(t){let n=0;for(let e=0,r=this.o.length;e<r;++e){const r=this.o[e];r.observer!==t&&(e!==n&&(this.o[n]=r),++n)}this.o.length=n}collectInterestedObservers(t,n,e,r,o){this.o.forEach((i=>{i.collectInterestedObservers(t,n,e,r,o)}))}appendTransientRegisteredObservers(t){this.o.forEach((n=>{n.options.subtree&&t.o.registerTransient(n)}))}registerTransient(t){this.o.push(new n(t.observer,this.i,t.options,t))}}function r(t,n,...e){"function"!=typeof queueMicrotask?Promise.resolve().then((()=>t.apply(n,e))):queueMicrotask((()=>t.apply(n,e)))}class o{constructor(){this.l=new Set,this.h=!1}appendRecord(t,n){t.m.push(n),this.l.add(t)}queueMutationObserverMicrotask(){this.h||(this.h=!0,r((()=>{this.p()}),this))}p(){this.h=!1;const t=Array.from(this.l);this.l.clear(),t.forEach((t=>{r((t=>{const n=t.takeRecords();var e;(e=t).t.forEach((t=>{t.node.o.removeTransientRegisteredObserver(t)})),e.t.length=0,n.length>0&&t.v(n,t)}),this,t)}))}}class i{constructor(t){this.N=t}deref(){return this.N}}const s=new class{constructor(){this.l=new o,this.S=[],this.T=new WeakSet}forEachRange(t){let n=this.S.length;for(let e=n-1;e>=0;--e){const r=this.S[e].deref(),o=null==r,i=!o&&!this.T.has(r);o||i?(this.S[e]=this.S[n-1],this.S.pop(),n-=1):t(r)}}addRange(t){const n=(e=t,"function"==typeof WeakRef?new WeakRef(e):new i(e));var e;this.S.push(n),this.T.add(t)}removeRange(t){this.T.delete(t)}};function u(t){return s}function l(t,...n){return n.some((n=>t.nodeType===n))}function c(t){return 2===t.nodeType}function a(t){return 3===t.nodeType||4===t.nodeType||8===t.nodeType||7===t.nodeType}function h(t){return 3===t.nodeType||4===t.nodeType}function f(t){return 1===t.nodeType}function d(t){return 10===t.nodeType}function m(t){switch(t.nodeType){case 3:case 7:case 8:return t.data.length;default:return t.childNodes.length}}function p(t){let n=t,e=[];for(;n;)e.unshift(n),n=n.parentNode;return e}function g(t){return l(t,9)?t:t.ownerDocument}function w(t){return t.parentNode.childNodes.indexOf(t)}function y(t){for(;t.parentNode;)t=t.parentNode;return t}function b(t,n){n(t);for(let e=t.firstChild;e;e=e.nextSibling)b(e,n)}function v(t,n){const e=[];return b(n,(r=>{if(r===n||1!==r.nodeType)return;const o=r;"*"!==t&&o.nodeName!==t||e.push(o)})),e}function x(t,n,e){""===t&&(t=null);const r=[];return b(e,(o=>{if(o===e||1!==o.nodeType)return;const i=o;"*"!==t&&i.namespaceURI!==t||"*"!==n&&i.localName!==n||r.push(i)})),r}function N(t,n,e){e||(e=g(t));let r=t.C(e);if(n)for(let n=t.firstChild;n;n=n.nextSibling)r.appendChild(N(n,!0,e));return r}function S(t,n){if(t.length<n)throw new TypeError(`Function should be called with at least ${n} arguments`)}const T={IndexSizeError:1,HierarchyRequestError:3,WrongDocumentError:4,InvalidCharacterError:5,NotFoundError:8,NotSupportedError:9,InUseAttributeError:10,InvalidStateError:11,NamespaceError:14,InvalidNodeTypeError:24};class E extends Error{constructor(t="",n="Error"){super(t),this.message=t,this.name=n,this.code=T[n]||0,this.stack=new Error(t).stack}}function C(t,n){return new E(`${t}: ${n}`,t)}function D(t){throw C("HierarchyRequestError",t)}function $(t){throw C("IndexSizeError",t)}function A(t){throw C("InvalidCharacterError",t)}function I(t){throw C("InvalidNodeTypeError",t)}function k(t){throw C("InvalidStateError",t)}function M(t){throw C("NamespaceError",t)}function R(t){throw C("NotFoundError",t)}function P(t){throw C("NotSupportedError",t)}function L(t){throw C("WrongDocumentError",t)}class O{constructor(t,n){this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null,this.type=t,this.target=n}}function z(t,n,e){const r=[],o=[];for(let i=n;i;i=i.parentNode)i.o.collectInterestedObservers(t,n,e,r,o);const i=u();r.forEach(((r,s)=>{const u=o[s],l=new O(t,n);void 0!==e.name&&void 0!==e.namespace&&(l.attributeName=e.name,l.attributeNamespace=e.namespace),void 0!==u&&(l.oldValue=u),void 0!==e.addedNodes&&(l.addedNodes=e.addedNodes),void 0!==e.removedNodes&&(l.removedNodes=e.removedNodes),void 0!==e.previousSibling&&(l.previousSibling=e.previousSibling),void 0!==e.nextSibling&&(l.nextSibling=e.nextSibling),i.l.appendRecord(r,l)})),i.l.queueMutationObserverMicrotask()}function V(t){const n=[];for(let e=t.firstElementChild;e;e=e.nextElementSibling)n.push(e);return n}function _(t){for(let n=t.previousSibling;n;n=n.previousSibling)if(f(n))return n;return null}function F(t){for(let n=t.nextSibling;n;n=n.nextSibling)if(f(n))return n;return null}function U(t,n){const e=t.previousSibling,r=t.nextSibling,o=l(t,1),i=o?t.previousElementSibling:null,s=o?t.nextElementSibling:null;if(t.parentNode=null,t.previousSibling=null,t.nextSibling=null,e?e.nextSibling=r:n.firstChild=r,r?r.previousSibling=e:n.lastChild=e,n.childNodes.splice(n.childNodes.indexOf(t),1),o){const e=function(t){return l(t,1,9,11)?t:null}(n);e&&(e.firstElementChild===t&&(e.firstElementChild=s),e.lastElementChild===t&&(e.lastElementChild=i),e.childElementCount-=1)}if(l(n,9)){const e=n;l(t,1)?e.documentElement=null:l(t,10)&&(e.doctype=null)}}function q(t,n,e){if(l(n,9,11,1)||D("parent must be a Document, DocumentFragment or Element node"),t.contains(n)&&D("node must not be an inclusive ancestor of parent"),e&&e.parentNode!==n&&R("child is not a child of parent"),l(t,11,10,1,3,4,7,8)||D("node must be a DocumentFragment, DocumentType, Element, Text, ProcessingInstruction or Comment node"),l(t,3)&&l(n,9)&&D("can not insert a Text node under a Document"),l(t,10)&&!l(n,9)&&D("can only insert a DocumentType node under a Document"),l(n,9)){const r=n;switch(t.nodeType){case 11:const n=t;n.firstElementChild!==n.lastElementChild&&D("can not insert more than one element under a Document"),Array.from(n.childNodes).some((t=>l(t,3)))&&D("can not insert a Text node under a Document"),n.firstElementChild&&(r.documentElement||e&&l(e,10)||e&&r.doctype&&w(e)<w(r.doctype))&&D("Document should contain at most one doctype, followed by at most one element");break;case 1:(r.documentElement||e&&l(e,10)||e&&r.doctype&&w(e)<w(r.doctype))&&D("Document should contain at most one doctype, followed by at most one element");break;case 10:(r.doctype||e&&r.documentElement&&w(r.documentElement)<w(e)||!e&&r.documentElement)&&D("Document should contain at most one doctype, followed by at most one element")}}}function B(t,n,e){q(t,n,e);let r=e;return r===t&&(r=t.nextSibling),Q(t,g(n)),W(t,n,r),t}function W(t,n,e,r=!1){const o=function(t){return 11===t.nodeType}(t),i=o?Array.from(t.childNodes):[t],s=i.length;if(0===s)return;if(o&&(i.forEach((t=>H(t,!0))),z("childList",t,{removedNodes:i})),null!==e){const t=w(e);u().forEachRange((e=>{e.startContainer===n&&e.startOffset>t&&(e.startOffset+=s),e.endContainer===n&&e.endOffset>t&&(e.endOffset+=s)}))}let l=null===e?n.lastChild:e.previousSibling;i.forEach((t=>{!function(t,n,e){t.parentNode=n;const r=null===e?n.lastChild:e.previousSibling,o=null===e?null:e;if(t.previousSibling=r,t.nextSibling=o,r?r.nextSibling=t:n.firstChild=t,o?(o.previousSibling=t,n.childNodes.splice(n.childNodes.indexOf(o),0,t)):(n.lastChild=t,n.childNodes.push(t)),f(t)){const e=n;let i=null;for(let t=r;t;t=t.previousSibling){if(f(t)){i=t;break}const n=t;if(!d(n)){i=n.previousElementSibling;break}}let s=null;for(let t=o;t;t=t.nextSibling){if(f(t)){s=t;break}s=t.nextElementSibling;break}i||(e.firstElementChild=t),s||(e.lastElementChild=t),e.childElementCount+=1}(function(t){return 9===t.nodeType})(n)&&(f(t)?n.documentElement=t:d(t)&&(n.doctype=t))}(t,n,e)})),r||z("childList",n,{addedNodes:i,nextSibling:e,previousSibling:l})}function X(t,n){return B(t,n,null)}function Y(t,n,e){if(l(e,9,11,1)||D("Can not replace under a non-parent node"),n.contains(e)&&D("Can not insert a node under its own descendant"),t.parentNode!==e&&R("child is not a child of parent"),l(n,11,10,1,3,4,7,8)||D("Can not insert a node that isn't a DocumentFragment, DocumentType, Element, Text, ProcessingInstruction or Comment"),l(n,3)&&l(e,9)&&D("can not insert a Text node under a Document"),l(n,10)&&!l(e,9)&&D("can only insert a DocumentType node under a Document"),l(e,9)){const r=e;switch(n.nodeType){case 11:const e=n;e.firstElementChild!==e.lastElementChild&&D("can not insert more than one element under a Document"),Array.from(e.childNodes).some((t=>l(t,3)))&&D("can not insert a Text node under a Document"),e.firstElementChild&&(r.documentElement&&r.documentElement!==t||t&&r.doctype&&w(t)<w(r.doctype))&&D("Document should contain at most one doctype, followed by at most one element");break;case 1:(r.documentElement&&r.documentElement!==t||r.doctype&&w(t)<w(r.doctype))&&D("Document should contain at most one doctype, followed by at most one element");break;case 10:(r.doctype&&r.doctype!==t||r.documentElement&&w(r.documentElement)<w(t))&&D("Document should contain at most one doctype, followed by at most one element")}}let r=t.nextSibling;r===n&&(r=n.nextSibling);const o=t.previousSibling;Q(n,g(e));let i=[];null!==t.parentNode&&(i.push(t),H(t,!0));const s=l(n,11)?Array.from(n.childNodes):[n];return W(n,e,r,!0),z("childList",e,{addedNodes:s,removedNodes:i,nextSibling:r,previousSibling:o}),t}function j(t,n){null!==t&&Q(t,g(n));const e=Array.from(n.childNodes);let r=[];null!==t&&(l(t,11)?t.childNodes.forEach((t=>{r.push(t)})):r.push(t)),e.forEach((t=>{H(t,!0)})),null!==t&&W(t,n,null,!0),(r.length>0||e.length>0)&&z("childList",n,{addedNodes:r,removedNodes:e})}function H(t,n=!1){const e=t.parentNode,r=w(t);u().forEachRange((n=>{t.contains(n.startContainer)&&(n.startContainer=e,n.startOffset=r),t.contains(n.endContainer)&&(n.endContainer=e,n.endOffset=r),n.startContainer===e&&n.startOffset>r&&(n.startOffset-=1),n.endContainer===e&&n.endOffset>r&&(n.endOffset-=1)}));const o=t.previousSibling,i=t.nextSibling;U(t,e);for(let n=e;n;n=n.parentNode)n.o.appendTransientRegisteredObservers(t);n||z("childList",e,{removedNodes:[t],nextSibling:i,previousSibling:o})}function Q(t,n){const e=g(t);t.parentNode&&H(t),n!==e&&b(t,(t=>{if(t.ownerDocument=n,l(t,1))for(const e of t.attributes)e.ownerDocument=n}))}function K(t){const n=[];return b(t,(t=>{l(t,3,4)&&n.push(t.data)})),n.join("")}function G(t,n){let e=null;if(""!==n){e=new(u().Text)(n)}j(e,t)}function J(t,n){const e=t.map((t=>t instanceof Node?t:n.createTextNode(String(t))));if(1===e.length)return e[0];{const t=n.createDocumentFragment();return e.forEach((n=>{t.appendChild(n)})),t}}function Z(t,n){B(J(n,g(t)),t,t.firstChild)}function tt(t,n){X(J(n,g(t)),t)}function nt(t,n){const e=J(n,g(t));q(e,t,null),j(e,t)}function et(t,n){const e=t.parentNode;if(null===e)return;let r=t.previousSibling;for(;null!==r&&n.indexOf(r)>=0;)r=r.previousSibling;B(J(n,g(t)),e,null===r?e.firstChild:r.nextSibling)}function rt(t,n){const e=t.parentNode;if(null===e)return;let r=t.nextSibling;for(;null!==r&&n.indexOf(r)>=0;)r=r.nextSibling;B(J(n,g(t)),e,r)}function ot(t,n){const e=t.parentNode;if(null===e)return;let r=t.nextSibling;for(;null!==r&&n.indexOf(r)>=0;)r=r.nextSibling;const o=J(n,g(t));t.parentNode===e?Y(t,o,e):B(o,e,r)}function it(t){null!==t.parentNode&&H(t)}function st(t,n){const e=n.startContainer;l(e,7)&&D("Can not insert into a processing instruction"),l(e,8)&&D("Can not insert into a comment"),h(e)&&null===e.parentNode&&D("Can not insert into a text node without a parent");let r=null;r=h(e)?e:e.childNodes[n.startOffset]||null;const o=null===r?e:r.parentNode;q(t,o,r),h(e)&&(r=e.splitText(n.startOffset)),t===r&&(r=r.nextSibling),null!==t.parentNode&&H(t);let i=null===r?m(o):w(r);l(t,11)?i+=m(t):i+=1,B(t,o,r),n.collapsed&&n.setEnd(o,i)}function ut(t){return t>>>0}function lt(t){return null===t?"":String(t)}function ct(t){return null==t?"":String(t)}function at(t,n){return function(t,n){if(!(t instanceof n))throw new TypeError(`Value should be an instance of ${n.name}`)}(t,n),t}function ht(t,n){return null==t?null:at(t,n)}function ft(t){return void 0===t?null:t}const dt=new WeakMap;function mt(t){let n=dt.get(t);return void 0===n&&(n=Math.random(),dt.set(t,n)),n}class Node{constructor(){this.ownerDocument=null,this.parentNode=null,this.childNodes=[],this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.o=new e(this)}get parentElement(){return this.parentNode&&l(this.parentNode,1)?this.parentNode:null}hasChildNodes(){return!!this.childNodes.length}normalize(){let t=this.firstChild,n=0;for(g(this);t;){let e=t.nextSibling;if(!l(t,3)){t.normalize(),t=e;continue}const r=t;let o=r.length;if(0===o){H(t),--n,t=e;continue}let i="";const s=[];for(let t=r.nextSibling;t&&l(t,3);t=t.nextSibling)i+=t.data,s.push(t);i&&r.replaceData(o,0,i);const c=u();for(let t=0,e=s.length;t<e;++t){const e=s[t],i=n+t+1;c.forEachRange((t=>{t.startContainer===e&&(t.startOffset+=o,t.startContainer=r),t.endContainer===e&&(t.endOffset+=o,t.endContainer=r),t.startContainer===this&&t.startOffset===i&&(t.startContainer=r,t.startOffset=o),t.endContainer===this&&t.endOffset===i&&(t.endContainer=r,t.endOffset=o)})),o+=e.length}for(;s.length;)H(s.shift());t=t.nextSibling,++n}}cloneNode(t=!1){return N(this,t)}compareDocumentPosition(t){if(S(arguments,1),this===(t=at(t,Node)))return 0;let n=t,e=this,r=null,o=null;if(c(n)&&(r=n,n=r.ownerElement),c(e)&&(o=e,e=o.ownerElement,null!==r&&null!==n&&e===n))for(const t of e.attributes){if(t===r)return Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|Node.DOCUMENT_POSITION_PRECEDING;if(t===o)return Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|Node.DOCUMENT_POSITION_FOLLOWING}if(null===n||null===e)return Node.DOCUMENT_POSITION_DISCONNECTED|Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|(mt(n||r)>mt(e||o)?Node.DOCUMENT_POSITION_FOLLOWING:Node.DOCUMENT_POSITION_PRECEDING);const i=p(n),s=p(e);if(i[0]!==s[0])return Node.DOCUMENT_POSITION_DISCONNECTED|Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|(mt(i[0])>mt(s[0])?Node.DOCUMENT_POSITION_FOLLOWING:Node.DOCUMENT_POSITION_PRECEDING);let u=0;for(;u<i.length&&u<s.length&&i[u]===s[u];)++u;const l=n!==e&&u===i.length,a=n!==e&&u===s.length;return l&&null===r||n===e&&null!==o?Node.DOCUMENT_POSITION_CONTAINS|Node.DOCUMENT_POSITION_PRECEDING:a&&null===o||n===e&&null!==r?Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING:l||w(i[u])<w(s[u])?Node.DOCUMENT_POSITION_PRECEDING:Node.DOCUMENT_POSITION_FOLLOWING}contains(t){for(S(arguments,1),t=ht(t,Node);t&&t!=this;)t=t.parentNode;return t===this}isDefaultNamespace(t){S(arguments,1),""===(t=ft(t))&&(t=null);return this.lookupNamespaceURI(null)===t}insertBefore(t,n){return S(arguments,2),B(t=at(t,Node),this,n=ht(n,Node))}appendChild(t){return S(arguments,1),X(t=at(t,Node),this)}replaceChild(t,n){return S(arguments,2),t=at(t,Node),Y(n=at(n,Node),t,this)}removeChild(t){return S(arguments,1),function(t,n){return t.parentNode!==n&&R("child is not a child of parent"),H(t),t}(t=at(t,Node),this)}}function pt(t,n,e,r){z("attributes",n,{name:t.localName,namespace:t.namespaceURI,oldValue:e})}function gt(t,n){pt(t,t.ownerElement,t.value),t.D=n}function wt(t,n,e=!1){e||pt(t,n,null,t.value),n.attributes.push(t),t.ownerElement=n}function yt(t){const n=t.ownerElement;pt(t,n,t.value),n.attributes.splice(n.attributes.indexOf(t),1),t.ownerElement=null}Node.ELEMENT_NODE=1,Node.ATTRIBUTE_NODE=2,Node.TEXT_NODE=3,Node.CDATA_SECTION_NODE=4,Node.ENTITY_REFERENCE_NODE=5,Node.ENTITY_NODE=6,Node.PROCESSING_INSTRUCTION_NODE=7,Node.COMMENT_NODE=8,Node.DOCUMENT_NODE=9,Node.DOCUMENT_TYPE_NODE=10,Node.DOCUMENT_FRAGMENT_NODE=11,Node.NOTATION_NODE=12,Node.DOCUMENT_POSITION_DISCONNECTED=1,Node.DOCUMENT_POSITION_PRECEDING=2,Node.DOCUMENT_POSITION_FOLLOWING=4,Node.DOCUMENT_POSITION_CONTAINS=8,Node.DOCUMENT_POSITION_CONTAINED_BY=16,Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,Node.prototype.ELEMENT_NODE=1,Node.prototype.ATTRIBUTE_NODE=2,Node.prototype.TEXT_NODE=3,Node.prototype.CDATA_SECTION_NODE=4,Node.prototype.ENTITY_REFERENCE_NODE=5,Node.prototype.ENTITY_NODE=6,Node.prototype.PROCESSING_INSTRUCTION_NODE=7,Node.prototype.COMMENT_NODE=8,Node.prototype.DOCUMENT_NODE=9,Node.prototype.DOCUMENT_TYPE_NODE=10,Node.prototype.DOCUMENT_FRAGMENT_NODE=11,Node.prototype.NOTATION_NODE=12;class Attr extends Node{get nodeType(){return 2}get nodeName(){return this.name}get nodeValue(){return this.D}set nodeValue(t){bt(this,t=ct(t))}get textContent(){return this.D}set textContent(t){bt(this,t=ct(t))}lookupPrefix(t){return S(arguments,1),null!==this.ownerElement?this.ownerElement.lookupPrefix(t):null}lookupNamespaceURI(t){return S(arguments,1),null===this.ownerElement?null:this.ownerElement.lookupNamespaceURI(t)}get value(){return this.D}set value(t){bt(this,t)}constructor(t,n,e,r,o){super(),this.namespaceURI=t,this.prefix=n,this.localName=e,this.name=null===n?e:`${n}:${e}`,this.D=r,this.ownerElement=o,this.ownerDocument=o?o.ownerDocument:u().document}C(t){const n=new(u().Attr)(this.namespaceURI,this.prefix,this.localName,this.value,null);return n.ownerDocument=t,n}}function bt(t,n){n=String(n);null===t.ownerElement?t.D=n:gt(t,n)}class CharacterData extends Node{get nodeValue(){return this.$}set nodeValue(t){t=ct(t),vt(this,0,this.length,t)}get textContent(){return this.$}set textContent(t){t=ct(t),vt(this,0,this.length,t)}lookupPrefix(t){S(arguments,1);const n=this.parentElement;return null!==n?n.lookupPrefix(t):null}lookupNamespaceURI(t){S(arguments,1);const n=this.parentElement;return null===n?null:n.lookupNamespaceURI(t)}before(...t){et(this,t)}after(...t){rt(this,t)}replaceWith(...t){ot(this,t)}remove(){it(this)}get previousElementSibling(){return _(this)}get nextElementSibling(){return F(this)}get data(){return this.$}set data(t){t=lt(t),vt(this,0,this.length,t)}get length(){return this.data.length}constructor(t){super(),this.$=String(t)}substringData(t,n){return S(arguments,2),xt(this,t,n)}appendData(t){S(arguments,1),vt(this,this.length,0,t)}insertData(t,n){S(arguments,1),vt(this,t,0,n)}deleteData(t,n){S(arguments,2),vt(this,t,n,"")}replaceData(t,n,e){S(arguments,3),vt(this,t,n,e)}}function vt(t,n,e,r){n=ut(n),e=ut(e);const o=t.length;n>o&&$("can not replace data past the node's length"),n+e>o&&(e=o-n),z("characterData",t,{oldValue:t.data});const i=t.data,s=i.substring(0,n)+r+i.substring(n+e);t.$=s;u().forEachRange((o=>{o.startContainer===t&&o.startOffset>n&&o.startOffset<=n+e&&(o.startOffset=n),o.endContainer===t&&o.endOffset>n&&o.endOffset<=n+e&&(o.endOffset=n),o.startContainer===t&&o.startOffset>n+e&&(o.startOffset=o.startOffset+r.length-e),o.endContainer===t&&o.endOffset>n+e&&(o.endOffset=o.endOffset+r.length-e)}))}function xt(t,n,e){n=ut(n),e=ut(e);const r=t.length;return n>r&&$("can not substring data past the node's length"),n+e>r?t.data.substring(n):t.data.substring(n,n+e)}class Text extends CharacterData{get nodeType(){return 3}get nodeName(){return"#text"}constructor(t=""){super(t);const n=u();this.ownerDocument=n.document}splitText(t){return S(arguments,1),function(t,n){const e=t.length;n>e&&$("can not split past the node's length");const r=e-n,o=xt(t,n,r),i=new(u().Text)(o);i.ownerDocument=t.ownerDocument;const s=t.parentNode;if(null!==s){W(i,s,t.nextSibling);const e=w(t)+1;u().forEachRange((r=>{r.startContainer===t&&r.startOffset>n&&(r.startContainer=i,r.startOffset-=n),r.endContainer===t&&r.endOffset>n&&(r.endContainer=i,r.endOffset-=n),r.startContainer===s&&r.startOffset===e&&(r.startOffset+=1),r.endContainer===s&&r.endOffset===e&&(r.endOffset+=1)}))}return vt(t,n,r,""),i}(this,t=ut(t))}C(t){const n=new(u().Text)(this.data);return n.ownerDocument=t,n}get wholeText(){const t=[this.data];let n=this.previousSibling;for(;null!==n&&l(n,3,4);){const e=n.data;t.unshift(e),n=n.previousSibling}let e=this.nextSibling;for(;null!==e&&l(e,3,4);){const n=e.data;t.push(n),e=e.nextSibling}return t.join("")}}class CDATASection extends Text{get nodeType(){return 4}get nodeName(){return"#cdata-section"}constructor(t){super(t)}C(t){const n=new(u().CDATASection)(this.data);return n.ownerDocument=t,n}}class Nt extends CharacterData{get nodeType(){return 8}get nodeName(){return"#comment"}constructor(t=""){super(t);const n=u();this.ownerDocument=n.document}C(t){const n=new(u().Comment)(this.data);return n.ownerDocument=t,n}}class DocumentType extends Node{get nodeType(){return 10}get nodeName(){return this.name}get nodeValue(){return null}set nodeValue(t){}get textContent(){return null}set textContent(t){}lookupPrefix(t){return S(arguments,1),null}lookupNamespaceURI(t){return S(arguments,1),null}before(...t){et(this,t)}after(...t){rt(this,t)}replaceWith(...t){ot(this,t)}remove(){it(this)}constructor(t,n="",e=""){super(),this.name=t,this.publicId=n,this.systemId=e}C(t){const n=new(u().DocumentType)(this.name,this.publicId,this.systemId);return n.ownerDocument=t,n}}function St(t,n,e,r,o){return new Attr(t,n,e,r,o)}function Tt(t,n,e,r=null){return po(t,n,e,r)}const Et="http://www.w3.org/1999/xhtml",Ct="http://www.w3.org/XML/1998/namespace",Dt="http://www.w3.org/2000/xmlns/";function $t(t){(function(t){const n=t.split(":");return!(n.length>2)&&n.every((t=>jr(t)))})(t)||A("The qualified name is not a valid QName")}function At(t,n){""===t&&(t=null),$t(n);let e=null,r=n;const o=n.indexOf(":");return o>=0&&(e=n.substring(0,o),r=n.substring(o+1)),null!==e&&null===t&&M("Qualified name with prefix can not have a null namespace"),"xml"===e&&t!==Ct&&M("xml prefix can only be used for the XML namespace"),"xmlns"!==n&&"xmlns"!==e||t===Dt||M("xmlns prefix or qualifiedName must use the XMLNS namespace"),t===Dt&&"xmlns"!==n&&"xmlns"!==e&&M("xmlns prefix or qualifiedName must be used for the XMLNS namespace"),{namespace:t,prefix:e,localName:r}}function It(t,n){if(t.namespaceURI===n&&null!==t.prefix)return t.prefix;const e=Array.from(t.attributes).find((t=>"xmlns"===t.prefix&&t.value===n));return e?e.localName:null!==t.parentElement?It(t.parentElement,n):null}function kt(t,n){return{success:!0,offset:t,value:n}}function Mt(t){return kt(t,void 0)}function Rt(t,n,e=!1){return{success:!1,offset:t,expected:n,fatal:e}}function Pt(t){return(n,e)=>{const r=e+t.length;return n.slice(e,r)===t?kt(r,t):Rt(e,[t])}}function Lt(t,n){return(e,r)=>{const o=e.codePointAt(r);return void 0!==o&&t(o)?Mt(r+function(t){return t>65535?2:1}(o)):Rt(r,n)}}function Ot(t,n){return(e,r)=>{const o=r;for(;;){const n=e.codePointAt(r);if(void 0===n)break;if(!t(n))break;r+=n>65535?2:1}return void 0!==n&&r===o?Rt(r,n):Mt(r)}}function zt(t,n,e){return Lt((e=>t<=e&&e<=n),e||[`${String.fromCodePoint(t)}-${String.fromCodePoint(n)}`])}function Vt(t,n){return(e,r)=>{const o=t(e,r);return o.success?kt(o.offset,n(o.value)):o}}function _t(t){return Vt(t,(()=>{}))}function Ft(t,n,e,r){return(o,i)=>{const s=t(o,i);return s.success?n(s.value)?s:Rt(i,e,r):s}}function Ut(t,n){return(e,r)=>{let o=null;for(const i of t){const t=i(e,r);if(t.success)return t;if(null===o||t.offset>o.offset?o=t:t.offset===o.offset&&void 0===n&&(o.expected=o.expected.concat(t.expected)),t.fatal)return t}return n=n||(null==o?void 0:o.expected)||[],o&&(o.expected=n),o||Rt(r,n)}}function qt(t){return(n,e)=>{const r=t(n,e);return r.success||r.fatal?r:kt(e,null)}}function Bt(t){return(n,e)=>{let r=[],o=e;for(;;){const e=t(n,o);if(!e.success){if(e.fatal)return e;break}if(r.push(e.value),e.offset===o)break;o=e.offset}return kt(o,r)}}function Wt(t){return(n,e)=>{let r=e;for(;;){const e=t(n,r);if(!e.success){if(e.fatal)return e;break}if(e.offset===r)break;r=e.offset}return Mt(r)}}function Xt(t,n,e){return(r,o)=>{const i=t(r,o);if(!i.success)return i;const s=n(r,i.offset);return s.success?kt(s.offset,e(i.value,s.value)):s}}function Yt(...t){return(n,e)=>{const r=[];for(const o of t){const t=o(n,e);if(!t.success)return t;e=t.offset,r.push(t.value)}return kt(e,r)}}function jt(...t){return(n,e)=>{for(const r of t){const t=r(n,e);if(!t.success)return t;e=t.offset}return Mt(e)}}function Ht(t,n){return t}function Qt(t,n){return n}function Kt(t){return Xt(t,Wt(t),Qt)}function Gt(t,n){return Xt(t,n,Qt)}function Jt(t,n){return Xt(t,n,Ht)}function Zt(t,n,e,r=!1){return Gt(t,r?sn(Jt(n,e)):Jt(n,e))}function tn(t){return(n,e)=>{const r=t(n,e);return r.success?kt(r.offset,n.slice(e,r.offset)):r}}function nn(t){return(n,e)=>{const r=t(n,e);return r.success?kt(e,r.value):r}}function en(t,n){return(e,r)=>t(e,r).success?Rt(r,n):Mt(r)}function rn(t,n,e){return Gt(en(n,e),t)}function on(t,n,e=0,r=[]){return(o,i)=>{const s=o.codePointAt(i+e);if(void 0===s)return Rt(i,r);const u=t[s];return void 0===u?void 0===n?Rt(i,r):n(o,i):u(o,i)}}function sn(t){return(n,e)=>{const r=t(n,e);return r.success?r:Rt(r.offset,r.expected,!0)}}const un=(t,n)=>t.length===n?Mt(n):Rt(n,["end of input"]);function ln(t){return Xt(t,un,Ht)}class cn{constructor(t,n){this.A=0,this.I=0,this.k=t,this.M=n}next(){if(this.A>=this.M.length)return{done:!0,value:un(this.k,this.I)};const{parser:t,type:n}=this.M[this.A],e=t(this.k,this.I);return e.success?(this.I=e.offset,1!==n&&(this.A+=1),void 0===e.value?this.next():{done:!1,value:e.value}):0===n||e.fatal?{done:!0,value:e}:(this.A+=1,this.next())}}function an(t){return(n,e)=>{const r=e,o=t(n,e);return o.success?kt(o.offset,Object.assign({input:n,start:r,end:o.offset},o.value)):o}}const hn=Pt("_"),fn=Pt("-"),dn=Pt("."),mn=Pt('"'),pn=Pt("'"),gn=Pt("<"),wn=Pt(">"),yn=Pt("&"),bn=Pt("="),vn=Pt("["),xn=Pt("]"),Nn=Pt(";"),Sn=Pt("%"),Tn=Pt("("),En=Pt(")"),Cn=Pt("+"),Dn=Pt(","),$n=Pt("?"),An=Pt("*"),In=Pt("|"),kn=Pt("]]>"),Mn=Pt("\x3c!--"),Rn=Pt("--\x3e"),Pn=Pt("<?"),Ln=Pt("?>"),On=Pt("1."),zn=Pt("version"),Vn=Pt("encoding"),_n=Pt("standalone"),Fn=Pt("yes"),Un=Pt("no"),qn=Pt("<?xml"),Bn=Pt("<!DOCTYPE"),Wn=Pt("SYSTEM"),Xn=Pt("PUBLIC"),Yn=Pt("</"),jn=Pt("/>"),Hn=Pt("&#"),Qn=Pt("&#x"),Kn=Pt("<!ELEMENT"),Gn=Pt("EMPTY"),Jn=Pt("ANY"),Zn=Pt("#PCDATA"),te=Pt("<!ATTLIST"),ne=Pt("NOTATION"),ee=Pt("#REQUIRED"),re=Pt("#IMPLIED"),oe=Pt("#FIXED"),ie=Pt("<!ENTITY"),se=Pt("NDATA"),ue=Pt("<!NOTATION"),le=65,ce=90,ae=zt(le,ce),he=97,fe=122,de=zt(he,fe),me=zt(48,57),pe=Ut([me,zt(65,70),zt(97,102)],["hexadecimal digit"]);function ge(t){return 9===t||10===t||13===t||32<=t&&t<=55295||57344<=t&&t<=65533||65536<=t&&t<=1114111}const we=ln(Ot(ge));function ye(t){return 32===t||9===t||13===t||10===t}const be=Ot(ye,["whitespace"]),ve=ln(Ot(ye)),xe=58,Ne=95;function Se(t){return t===xe||le<=t&&t<=ce||t===Ne||he<=t&&t<=fe||192<=t&&t<=214||216<=t&&t<=246||248<=t&&t<=767||880<=t&&t<=893||895<=t&&t<=8191||8204<=t&&t<=8205||8304<=t&&t<=8591||11264<=t&&t<=12271||12289<=t&&t<=55295||63744<=t&&t<=64975||65008<=t&&t<=65533||65536<=t&&t<=983039}const Te=Lt(Se,["valid name start character"]);function Ee(t){return Se(t)||45===t||46===t||48<=t&&t<=57||183===t||768<=t&&t<=879||8255<=t&&t<=8256}const Ce=tn(Gt(Te,Ot(Ee))),De=ln(Ce),$e=Ft(Ce,(t=>!t.includes(":")),["name must not contain colon"],!0),Ae=tn(Ot(Ee,["valid name character"])),Ie=an(Vt(Ft(Ut([Vt(Zt(Qn,tn(Kt(pe)),Nn,!0),(t=>parseInt(t,16))),Vt(Zt(Hn,tn(Kt(me)),Nn,!0),(t=>parseInt(t,10)))]),(t=>ge(t)),["character reference must reference a valid character"],!0),(t=>({type:0,cp:t})))),ke=Ut([an(Vt(Zt(yn,$e,sn(Nn)),(t=>({type:1,name:t})))),Ie]),Me=an(Vt(Zt(Sn,$e,Nn),(t=>({type:2,name:t})))),Re=38,Pe=Ut([Zt(mn,Bt(Ut([tn(Ot((t=>37!==t&&t!==Re&&t!==Le&&ge(t)),[])),Me,ke])),mn,!0),Zt(pn,Bt(Ut([tn(Ot((t=>37!==t&&t!==Re&&t!==Oe&&ge(t)),[])),Me,ke])),pn,!0)]),Le=34,Oe=39,ze=on({[Le]:Zt(mn,Bt(on({[Re]:ke},tn(Ot((t=>t!==Be&&t!==Re&&t!==Le&&ge(t)),[])))),mn,!0),[Oe]:Zt(pn,Bt(on({[Re]:ke},tn(Ot((t=>t!==Be&&t!==Re&&t!==Oe&&ge(t)),[])))),pn,!0)},void 0,0,["quoted attribute value"]),Ve=ln(Bt(Ut([tn(Ot((t=>t!==Be&&t!==Re&&ge(t)),[])),ke]))),_e=Ft(Ut([Zt(mn,tn(Ot((t=>t!==Le&&ge(t)))),mn),Zt(pn,tn(Ot((t=>t!==Oe&&ge(t)))),pn)]),(t=>!t.includes("#")),["system identifier must not contain a fragment identifier"],!0);function Fe(t){return 32===t||13===t||10===t||he<=t&&t<=fe||le<=t&&t<=ce||48<=t&&t<=57||33<=t&&t<=47&&34!==t&&38!==t||58<=t&&t<=64&&60!==t&&62!==t||95===t}const Ue=ln(Ot(Fe)),qe=Ut([Zt(mn,tn(Ot((t=>t!==Le&&Fe(t)))),mn,!0),Zt(pn,tn(Ot((t=>t!==Oe&&Fe(t)))),pn,!0)]),Be=60,We=tn(Kt(Ut([Ot((t=>t!==Be&&t!==Re&&93!==t&&ge(t)),[]),rn(_t(xn),kn,[])],["character data"]))),Comment=Vt(Zt(Mn,tn(Wt(Ut([Ot((t=>45!==t&&ge(t)),[]),Jt(_t(fn),en(fn,["comment content may not contain --"]))]))),Rn,!0),(t=>({type:3,data:t}))),Xe=Ft($e,(t=>"xml"!==t.toLowerCase()),['processing instruction target must not be "xml"'],!0),Ye=Zt(Pn,Xt(Xe,qt(Gt(be,tn(Wt(Ut([Ot((t=>63!==t&&ge(t)),[]),Jt(_t($n),en(wn,["PI data"]))]))))),((t,n)=>({type:4,target:t,data:n}))),Ln,!0),je=Pt("<![CDATA["),He=tn(Wt(Ut([Ot((t=>93!==t&&ge(t)),[]),rn(_t(xn),kn,["CData"])]))),Qe=an(Vt(Zt(je,He,kn,!0),(t=>({type:5,data:t})))),Ke=Zt(qt(be),bn,qt(be)),Ge=tn(Gt(On,Kt(me))),Je=Gt(be,Gt(zn,Gt(Ke,Ut([Zt(mn,Ge,mn,!0),Zt(pn,Ge,pn,!0)])))),Ze=tn(Gt(Ut([ae,de]),Wt(Ut([ae,de,me,_t(dn),_t(hn),_t(fn)])))),tr=Gt(be,Gt(Vn,Gt(Ke,Ut([Zt(mn,Ze,mn,!0),Zt(pn,Ze,pn,!0)])))),nr=Ut([Vt(Fn,(()=>!0)),Vt(Un,(()=>!1))]),er=Gt(be,Gt(_n,sn(Gt(Ke,Ut([Zt(mn,nr,mn,!0),Zt(pn,nr,pn,!0)]))))),rr=Zt(Jt(qn,nn(be)),Jt(Xt(Je,Xt(qt(tr),qt(er),((t,n)=>[t,n])),((t,[n,e])=>({type:6,version:t,encoding:n,standalone:e}))),qt(be)),Ln,!0),or=an(Vt(Ce,(t=>({name:t})))),ir=Xt(or,Gt(sn(Ke),sn(ze)),((t,n)=>({name:t,value:n}))),sr=Vt(Yt(gn,or,sn(Jt(Bt(Gt(be,ir)),qt(be))),sn(on({47:Vt(jn,(()=>!0))},Vt(wn,(()=>!1)),0,[">","/>"]))),(([t,n,e,r])=>({type:r?9:7,name:n,attributes:e}))),ur=an(Vt(Zt(Yn,Jt(Ce,qt(be)),wn,!0),(t=>({type:8,name:t})))),lr=Ut([$n,An,Cn]),cr=Jt(Ut([_t(Ce),function(t,n){return ar(t,n)},function(t,n){return hr(t,n)}]),_t(qt(lr))),ar=jt(Tn,qt(be),cr,Kt(Yt(qt(be),In,qt(be),sn(cr))),qt(be),En);const hr=jt(Tn,qt(be),cr,Wt(Yt(qt(be),Dn,qt(be),sn(cr))),qt(be),En);const fr=Jt(Ut([ar,hr]),qt(lr)),dr=jt(Tn,qt(be),Zn,Ut([jt(Wt(jt(qt(be),In,qt(be),Ce)),qt(be),En,An),_t(Jt(qt(be),En))])),mr=Jt(Kn,sn(jt(be,Ce,be,Ut([_t(Gn),_t(Jn),_t(dr),_t(fr)]),qt(be),wn))),pr=Pt("CDATA"),gr=Ut([Pt("IDREFS"),Pt("IDREF"),Pt("ID"),Pt("ENTITY"),Pt("ENTITIES"),Pt("NMTOKENS"),Pt("NMTOKEN")]),wr=Ut([Jt(ne,sn(jt(be,Tn,qt(be),$e,Wt(jt(qt(be),In,qt(be),$e)),qt(be),En))),Jt(Tn,sn(jt(qt(be),Ae,Wt(jt(qt(be),In,qt(be),Ae)),qt(be),En)))]),yr=Ut([Vt(pr,(()=>!0)),Vt(gr,(()=>!1)),Vt(wr,(()=>!1))]),br=Ut([Vt(ee,(()=>({type:0}))),Vt(re,(()=>({type:1}))),Xt(Vt(qt(Jt(oe,be)),(t=>null!==t)),ze,((t,n)=>({type:2,fixed:t,value:n})))]),vr=Xt(Gt(be,or),sn(Xt(Gt(be,yr),Gt(be,br),((t,n)=>({isCData:t,def:n})))),((t,{isCData:n,def:e})=>({name:t,isCData:n,def:e}))),xr=Zt(Jt(te,be),Xt(Ce,sn(Bt(vr)),((t,n)=>({type:0,name:t,attdefs:n}))),Gt(qt(be),wn),!0),Nr=Ut([Vt(Gt(Wn,sn(Gt(be,_e))),(t=>({publicId:null,systemId:t}))),Gt(Xn,Xt(sn(Gt(be,qe)),Gt(be,_e),((t,n)=>({publicId:t,systemId:n}))))]),Sr=Ut([Pe,Xt(Nr,qt(Gt(Zt(be,se,be),$e)),((t,n)=>({ids:t,ndata:n})))]),Tr=Zt(ie,Xt(Gt(be,$e),sn(Gt(be,Sr)),((t,n)=>({type:1,name:t,value:n}))),Gt(qt(be),wn)),Er=Ut([Pe,_t(Nr)]),Cr=Zt(Jt(ie,Gt(be,Sn)),Xt(Gt(be,$e),sn(Gt(be,Er)),((t,n)=>n?{type:2,name:t,value:n}:void 0)),Gt(qt(be),wn),!0),Dr=Gt(nn(ie),sn(Ut([Tr,Cr]))),$r=Zt(Jt(qn,nn(be)),Jt(Xt(qt(Je),tr,((t,n)=>({type:6,version:t,encoding:n,standalone:null}))),qt(be)),Ln,!0),Ar=Vt(Jt(Jt(Xn,be),sn(qe)),(t=>({publicId:t,systemId:null}))),Ir=Zt(ue,Xt(Zt(be,$e,be),Ut([_t(Nr),_t(Ar)]),(()=>{})),Gt(qt(be),wn),!0),kr=Ut([_t(mr),xr,Dr,_t(Ir),_t(Ye),_t(Comment)]),Mr=Ut([_t(Me),_t(be)]),Rr=function(t){return Vt(t,(t=>t.filter((t=>void 0!==t))))}(Bt(Ut([kr,Mr]))),Pr=Gt(Bn,sn(Vt(Yt(be,Ce,qt(Gt(be,Nr)),qt(be),qt(Jt(Zt(vn,Rr,xn,!0),qt(be))),wn),(([t,n,e,r,o,i])=>({type:10,name:n,ids:e,intSubset:o}))))),Lr={parser:on({[Be]:on({47:ur,33:Ut([Comment,Qe]),63:Ye},sr,1),[Re]:ke},We),type:1};function Or(t){return new cn(t,[Lr])}const zr=Ut([Comment,Ye,be]),Vr=[...[{parser:rr,type:2},{parser:zr,type:1},{parser:Pr,type:2},{parser:zr,type:1}],...[{parser:sr,type:0},Lr]];function _r(t){return new cn(t,Vr)}const Fr=[{parser:$r,type:2},Lr];function Ur(t){return new cn(t,Fr)}function qr(t){return Array.from(t,(t=>Yr(t)?t:"[invalid character]")).join("")}function Br(t,n,e){const r=Array.from(t);if(r.length<e)return t;switch(n){case 0:return"…"+r.slice(-e).join("");case 1:return r.slice(0,e).join("")+"…"}const o=0|Math.min(r.length/2,e/2);return r.slice(0,o).join("")+"…"+r.slice(-o).join("")}function Wr(t,n){const{line:e,char:r}=function(t,n){let e=1,r=1,o=0;for(;o<n;){const n=t.codePointAt(o);r++,o+=n>65535?2:1,10===n&&(e++,r=1)}return{line:e,char:r}}(n.input,n.start);throw new Error(`${t}\n${`At line ${e}, character ${r}:`}\n\n${function(t,n,e){const r=Br(qr(t.substring(n,e)),2,30),o=t.lastIndexOf("\n",n),i=Br(qr(t.substring(o+1,n)),0,55-r.length),s=t.indexOf("\n",e),u=Br(qr(s>0?t.substring(e,s):t.substring(e)),1,80-r.length-i.length),l=Array.from(i,(t=>Hr(t)?t:" ")).join("");return`${i}${r}${u}\n${l}${"^".repeat(Math.max(Array.from(r).length,1))}`}(n.input,n.start,n.end)}`)}function Xr(t,n,e,r){const o=Array.from(new Set(e),(t=>t.includes('"')?`'${t}'`:`"${t}"`)),i=n.codePointAt(r),s=i?String.fromCodePoint(i):"";Wr(`Parsing ${t} failed, expected ${o.length>1?"one of "+o.join(", "):o[0]}`,{input:n,start:r,end:r+Math.max(s.length,1)})}function Yr(t){return we(t,0).success}function jr(t){return De(t,0).success}function Hr(t){return ve(t,0).success}function Qr(t){const n=[];for(const e of t)if("string"!=typeof e)switch(e.type){case 0:n.push(String.fromCodePoint(e.cp));break;case 1:n.push(`&${e.name};`);break;case 2:Wr(`reference to parameter entity "${e.name}" must not occur in an entity declaration in the internal subset`,e)}else n.push(e);return n.join("")}class Kr{constructor(t){if(this.R=new Map,this.P=new Map,this.L=new Set,this.O=new Set,t.intSubset)for(const n of t.intSubset)switch(n.type){case 0:{for(const t of n.attdefs)if(2===t.def.type)for(const n of t.def.value)"string"!=typeof n&&1===n.type&&(this.P.has(n.name)||this.L.has(n.name)||this.O.has(n.name)||Wr(`default value of attribute "${t.name.name}" contains reference to undefined entity "${n.name}"`,n),this.L.has(n.name)&&Wr(`default value of attribute "${t.name.name}" must not contain reference to external entity "${n.name}"`,n));let t=this.R.get(n.name);void 0===t&&(t=new Map,this.R.set(n.name,t));for(const e of n.attdefs)t.has(e.name.name)||t.set(e.name.name,e);break}case 2:if(Array.isArray(n.value))for(const t of n.value)"string"!=typeof t&&2===t.type&&Wr(`reference to parameter entity "${t.name}" must not occur in an entity declaration in the internal subset`,t);break;case 1:if(this.P.has(n.name)||this.L.has(n.name))continue;Array.isArray(n.value)?this.P.set(n.name,Qr(n.value)):null===n.value.ndata?this.L.add(n.name):this.O.add(n.name)}}getAttlist(t){return this.R.get(t.name)}getEntityReplacementText(t,n){const e=this.P.get(t.name);if(void 0===e&&(this.O.has(t.name)&&Wr(`reference to binary entity "${t.name}" is not allowed`,t),this.L.has(t.name))){if(n)return"";Wr(`reference to external entity "${t.name}" is not allowed in attribute value`,t)}return e}}const Gr=new Map([["lt","&#60;"],["gt",">"],["amp","&#38;"],["apos","'"],["quot",'"']]);function Jr(t,n,e,r){for(const o of n){if("string"==typeof o){t.push(o.replace(/[\r\n\t]/g," "));continue}if(0===o.type){t.push(String.fromCodePoint(o.cp));continue}null!==r&&r.includes(o.name)&&Wr(`reference to entity "${o.name}" must not be recursive`,o);let n=Gr.get(o.name);void 0===n&&null!==e&&(n=e.getEntityReplacementText(o,!1)),void 0===n&&Wr(`reference to unknown entity "${o.name}" in attribute value`,o);const i=Ve(n,0);i.success||Xr(`replacement text for entity "${o.name}"`,n,i.expected,i.offset),Jr(t,i.value,e,r?[o.name,...r]:[o.name])}}function Zr(t,n,e){const r=[];return Jr(r,t,e,null),n&&!n.isCData?r.join("").replace(/[ ]+/g," ").replace(/^[ ]+|[ ]+$/g,""):r.join("")}function to(t,n){const e=t.name,r=n.get(e);if(void 0!==r)return r;let o=null,i=e;const s=e.indexOf(":");s>=0&&(o=e.substring(0,s),i=e.substring(s+1)),(""===o||""===i||i.includes(":"))&&Wr(`the name "${e}" is not a valid qualified name`,t);const u={prefix:o,localName:i};return n.set(e,u),u}class no{constructor(t,n=null){var e;this.V=new Map,this._=null,this.F=t,this._=null!==(e=null!=n?n:null==t?void 0:t._)&&void 0!==e?e:null}getForElement(t,n){"xmlns"===t&&Wr('element names must not have the prefix "xmlns"',n);for(let n=this;null!==n;n=n.F){const e=n.V.get(t);if(void 0!==e)return e}if(null!==t&&this._){const n=this._(t);if(void 0!==n)return n}Wr(`use of undeclared element prefix "${t}"`,n)}getForAttribute(t,n,e){if(null===t)return"xmlns"===n?Dt:null;for(let n=this;null!==n;n=n.F){const e=n.V.get(t);if(void 0!==e)return e}if(this._){const n=this._(t);if(void 0!==n)return n}Wr(`use of undeclared attribute prefix ${t}`,e)}static fromAttrs(t,n,e,r,o){let i=t,s=!1;const u=(n,e,r)=>{null!==n||e!==Ct&&e!==Dt||Wr(`the namespace "${e}" must not be used as the default namespace`,r),e===Dt&&Wr(`the namespace "${Dt}" must not be bound to a prefix`,r),e===Ct&&"xml"!==n&&Wr(`the namespace "${Ct}" must be bound only to the prefix "xml"`,r),e!==Ct&&"xml"===n&&Wr(`the xml namespace prefix must not be bound to any namespace other than "${Ct}"`,r),null!==n&&null===e&&Wr(`the prefix "${n}" must not be undeclared`,r),s||(i=new no(t),s=!0),i.V.set(n,e)},l=(t,n)=>{const{prefix:l,localName:c}=to(t,o),a=null==e?void 0:e.get(t.name);if(null!==l||"xmlns"!==c||s&&i.V.has(null)){if(!("xmlns"!==l||s&&i.V.has(c))){"xmlns"===c&&Wr('the "xmlns" namespace prefix must not be declared',t);const e=Zr(n,a,r)||null;u(c,e,t)}}else{const e=Zr(n,a,r)||null;u(null,e,t)}};for(const t of n.attributes)l(t.name,t.value);if(e)for(const t of e.values()){const n=t.def;2===n.type&&l(t.name,n.value)}return i}static default(t){const n=new no(null,t);return n.V.set(null,null),n.V.set("xml",Ct),n.V.set("xmlns",Dt),n}}const eo=no.default(null);function ro(t,n){W(n,t,null,!0)}const oo=100,io=4194304;function so(t,n,e,r,{entityExpansionMaxAmplification:o=oo,entityExpansionThreshold:i=io,treatCDataAsText:s=!1}){var u,l;const c=g(r);let a={parent:null,root:r,namespaces:e,entityRoot:!0},h=null;const d=new Map;let m=[];function p(){if(m.length>0){const t=m.join("");if(a.root===c){if(!Hr(t))throw new Error("document must not contain text outside of elements")}else ro(a.root,c.createTextNode(m.join("")));m.length=0}}const w=(t=function(t){return t.replace(/\r\n?/g,"\n")}(t=t.replace(/^\ufeff/,""))).length;let y=w,b=null,v={parent:null,entity:null,iterator:n(t)};for(;v;){let n=v.iterator.next();for(;!n.done;n=v.iterator.next()){const t=n.value;if("string"!=typeof t){switch(t.type){case 0:a.root===c&&null!==c.documentElement&&Wr("character reference must not appear after the document element",t),m.push(String.fromCodePoint(t.cp));continue;case 1:{a.root===c&&null!==c.documentElement&&Wr(`reference to entity "${t.name}" must not appear after the document element`,t);for(let n=v;n;n=n.parent)n.entity===t.name&&Wr(`reference to entity "${t.name}" must not be recursive`,t);let n=Gr.get(t.name);if(void 0===n&&null!==h&&(n=h.getEntityReplacementText(t,!0)),void 0===n&&Wr(`reference to unknown entity "${t.name}" in content`,t),null===b&&(b=t),y+=n.length,y>i){y/w>o&&Wr("too much entity expansion",b)}a={parent:a,root:a.root,namespaces:a.namespaces,entityRoot:!0},v={parent:v,entity:t.name,iterator:Or(n)};continue}case 5:if(s){m.push(t.data);continue}}switch(p(),t.type){case 5:a.root===c&&null!==c.documentElement&&Wr("CData section must not appear after the document element",t),ro(a.root,c.createCDATASection(t.data));continue;case 3:ro(a.root,c.createComment(t.data));continue;case 10:h=new Kr(t),ro(a.root,c.implementation.createDocumentType(t.name,(null===(u=t.ids)||void 0===u?void 0:u.publicId)||"",(null===(l=t.ids)||void 0===l?void 0:l.systemId)||""));continue;case 4:ro(a.root,c.createProcessingInstruction(t.target,t.data||""));continue;case 7:case 9:{a.root===c&&null!==c.documentElement&&Wr(`document must contain a single root element, but found "${c.documentElement.nodeName}" and "${t.name.name}"`,t.name);const n=h?h.getAttlist(t.name):void 0,e=no.fromAttrs(a.namespaces,t,n,h,d),{prefix:r,localName:o}=to(t.name,d),i=e.getForElement(r,t.name),s=Tt(c,o,i,r);for(const r of t.attributes){const{prefix:o,localName:i}=to(r.name,d),u=e.getForAttribute(o,i,r.name),l=null==n?void 0:n.get(r.name.name);s.hasAttributeNS(u,i)&&Wr(`attribute "${r.name.name}" must not appear multiple times on element "${t.name.name}"`,r.name);wt(St(u,o,i,Zr(r.value,l,h),s),s,!0)}if(n)for(const t of n.values()){const n=t.def;if(2!==n.type)continue;const{prefix:r,localName:o}=to(t.name,d),i=e.getForAttribute(r,o,t.name);if(s.hasAttributeNS(i,o))continue;wt(St(i,r,o,Zr(n.value,t,h),s),s,!0)}ro(a.root,s),7===t.type&&(a={parent:a,root:s,namespaces:e,entityRoot:!1});continue}case 8:f(a.root)&&a.root.nodeName===t.name||Wr(`non-well-formed element: found end tag "${t.name}" but expected ${f(a.root)?`"${a.root.nodeName}"`:"no such tag"}`,t),a=a.parent;continue}}else m.push(t)}if(n.value.success||Xr(v.entity?`replacement text for entity ${v.entity}`:r===c?"document":"fragment",t,n.value.expected,n.value.offset),!a.entityRoot)throw new Error(`${v.entity?`replacement text for entity "${v.entity}"`:r===c?"document":"fragment"} is not well-formed - element "${a.root.nodeName}" is missing a closing tag`);v=v.parent,v&&(a=a.parent,null===v.entity&&(b=null))}p()}function uo(t,n={}){const e=new Document;return so(t,_r,eo,e,n),e}class lo{constructor(t){this.U=new Map,this.q=new Map,this.F=t}static new(){const t=new lo(null);return t.add(null,null),t.add("xml",Ct),t.add("xmlns",Dt),t}add(t,n){const e=this.q.get(n);void 0===e?this.q.set(n,[t]):e.push(t),this.U.set(t,n)}recordNamespaceInformation(t){const n=new lo(this);for(const e of t.attributes){if(e.namespaceURI!==Dt)continue;const t=""===e.value?null:e.value,r=null===e.prefix?null:e.localName;n.add(r,t)}return n}B(t){return this.U.get(t)}W(t){var n;return null===(n=this.F)||void 0===n?void 0:n.prefixToNamespace(t)}prefixToNamespace(t){const n=this.B(t);return void 0!==n?n:this.W(t)}shouldSerializeDeclaration(t,n){return this.prefixToNamespace(t)===n&&this.W(t)!==n}X(t,n){let e=this;for(;e;){const r=e.q.get(t);if(void 0!==r)for(let e=r.length-1;e>=0;--e){const o=r[e];if((n||null!==o)&&this.prefixToNamespace(o)===t)return o}e=e.F}}getPreferredPrefix(t,n){var e;if(t.namespaceURI===Ct)return"xml";const r=c(t);if(t.namespaceURI===Dt)return r&&null===t.prefix?null:"xmlns";if(r&&null===t.namespaceURI)return null;if(!r){let n=null!==(e=this.W(null))&&void 0!==e?e:null;if(t.namespaceURI===n)return null}if((!r||null!==t.prefix)&&this.prefixToNamespace(t.prefix)===t.namespaceURI)return t.prefix;const o=this.X(t.namespaceURI,!r);if(void 0!==o)return o;if(r){const e=this.B(t.prefix);if(!(null!==t.prefix&&(void 0===e||e===t.namespaceURI)))for(;;){const t=`ns${n.value}`;if(n.value+=1,void 0===this.B(t))return t}}return t.prefix}}const co=["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function ao(t,n,e=!1){const r=e?[t]:t.childNodes,o=[];for(const t of r)ho(t,n,o);return o.join("")}function ho(t,n,e){const r=lo.new(),o={value:1};try{fo(t,r,o,n,e)}catch(t){return k(t.message)}}function fo(t,n,e,r,o){switch(t.nodeType){case 1:return void function(t,n,e,r,o){const i=t;if(r&&(i.localName.indexOf(":")>=0||!jr(i.localName)))throw new Error(`Can not serialize an element because the localName "${i.localName}" is not allowed.`);o.push("<");let s="",u=!1;const l=n.recordNamespaceInformation(i);if("xmlns"===i.prefix&&r)throw new Error('Can not serialize an element with prefix "xmlns" because it will not legally round-trip in a conforming XML parser.');const c=l.getPreferredPrefix(i,e);null!==c&&(s+=`${c}:`);s+=i.localName,o.push(s),l.prefixToNamespace(c)!==i.namespaceURI&&(l.add(c,i.namespaceURI),null===c?o.push(' xmlns="'):o.push(" xmlns:",c,'="'),o.push(mo(i.namespaceURI,r),'"'));(function(t,n,e,r,o){const i=[];for(const s of t.attributes){let t=n.getPreferredPrefix(s,e);if(s.namespaceURI===Dt){const t=""===s.value?null:s.value;if(r&&t===Dt)throw new Error("The serialization of this attribute would produce invalid XML because the XMLNS namespace is reserved and cannot be applied as an element's namespace via XML parsing.");if(t===Ct||t===Dt)continue;const e=null===s.prefix?null:s.localName;if(r&&null!==s.prefix&&""===s.value)throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace. Use a default namespace declaration instead.");if(!n.shouldSerializeDeclaration(e,t))continue}if(r&&i.find((t=>t.localName===s.localName&&t.namespaceURI===s.namespaceURI)))throw new Error(`Can not serialize a duplicate attribute for namespaceURI "${s.namespaceURI}", localName "${s.localName}".`);if(i.push({namespaceURI:s.namespaceURI,localName:s.localName}),r&&(s.localName.indexOf(":")>=0||!jr(s.localName)||"xmlns"===s.localName&&null===s.namespaceURI))throw new Error(`Can not serialize an attribute because the localName "${s.localName}" is not allowed.`);null!==t&&n.prefixToNamespace(t)!==s.namespaceURI&&(o.push(" xmlns:",t,'="',mo(s.namespaceURI,r),'"'),n.add(t,s.namespaceURI)),o.push(" "),null!==t&&o.push(t,":"),o.push(s.localName,'="',mo(s.value,r),'"')}})(i,l,e,r,o),i.namespaceURI===Et&&!i.hasChildNodes()&&co.indexOf(i.localName)>=0&&(o.push(" /"),u=!0);i.namespaceURI===Et||i.hasChildNodes()||(o.push("/"),u=!0);if(o.push(">"),u)return;for(const n of t.childNodes)fo(n,l,e,r,o);o.push("</",s,">")}(t,n,e,r,o);case 9:return void function(t,n,e,r,o){const i=t;if(r&&null===i.documentElement)throw new Error("Can not serialize a document with no documentElement.");for(const t of i.childNodes)fo(t,n,e,r,o)}(t,n,e,r,o);case 8:return void function(t,n,e){const r=t;if(n&&(!Yr(r.data)||r.data.indexOf("--")>=0||r.data.endsWith("-")))throw new Error("Can not serialize a comment because it contains invalid characters.");e.push("\x3c!--",r.data,"--\x3e")}(t,r,o);case 4:return void function(t,n,e){const r=t;e.push("<![CDATA[",r.data,"]]>")}(t,0,o);case 3:return void function(t,n,e){const r=t;if(n&&!Yr(r.data))throw new Error("Can not serialize a text node because it contains invalid characters.");let o=r.data;o=o.replace(/&/g,"&amp;"),o=o.replace(/</g,"&lt;"),o=o.replace(/>/g,"&gt;"),e.push(o)}(t,r,o);case 11:return void function(t,n,e,r,o){for(const i of t.childNodes)fo(i,n,e,r,o)}(t,n,e,r,o);case 10:return void function(t,n,e){const r=t;if(n&&(o=r.publicId,!Ue(o,0).success))throw new Error("Can not serialize a document type because the publicId contains invalid characters.");var o;if(n&&(!Yr(r.systemId)||r.systemId.indexOf('"')>=0&&r.systemId.indexOf("'")>=0))throw new Error("Can not serialize a document type because the systemId contains invalid characters.");e.push("<!DOCTYPE"),e.push(" "),e.push(r.name),""!==r.publicId&&e.push(' PUBLIC "',r.publicId,'"');""!==r.systemId&&""===r.publicId&&e.push(" SYSTEM");""!==r.systemId&&e.push(' "',r.systemId,'"');e.push(">")}(t,r,o);case 7:return void function(t,n,e){const r=t;if(n){if(r.target.indexOf(":")>=0)throw new Error(`Can not serialize a processing instruction because the target "${r.target}" may not contain ":".`);if("xml"===r.target.toLowerCase())throw new Error('Can not serialize a processing instruction because "xml" may not be used as target.')}if(n&&(!Yr(r.data)||r.data.indexOf("?>")>=0))throw new Error("Can not serialize a processing instruction because the data contains invalid characters.");e.push("<?",r.target," ",r.data,"?>")}(t,r,o);case 2:return;default:throw new TypeError("Only Nodes and Attr objects can be serialized by this algorithm.")}}function mo(t,n){if(n&&null!==t&&!Yr(t))throw new Error("Can not serialize an attribute value because it contains invalid characters.");return null===t?"":t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\t/g,"&#9;").replace(/\n/g,"&#10;").replace(/\r/g,"&#13;")}class Element extends Node{get nodeType(){return 1}get nodeName(){return this.tagName}get nodeValue(){return null}set nodeValue(t){}get textContent(){return K(this)}set textContent(t){G(this,t=ct(t))}lookupPrefix(t){return S(arguments,1),null===(t=ft(t))||""===t?null:It(this,t)}lookupNamespaceURI(t){if(S(arguments,1),""===(t=ft(t))&&(t=null),null!==this.namespaceURI&&this.prefix===t)return this.namespaceURI;let n=null;if(null!==t){const e=this.getAttributeNodeNS(Dt,t);e&&"xmlns"===e.prefix&&(n=e.value)}else{const t=this.getAttributeNodeNS(Dt,"xmlns");t&&null===t.prefix&&(n=t.value)}if(null!==n)return""!==n?n:null;const e=this.parentElement;return null===e?null:e.lookupNamespaceURI(t)}before(...t){et(this,t)}after(...t){rt(this,t)}replaceWith(...t){ot(this,t)}remove(){it(this)}get children(){return V(this)}prepend(...t){Z(this,t)}append(...t){tt(this,t)}replaceChildren(...t){nt(this,t)}get previousElementSibling(){return _(this)}get nextElementSibling(){return F(this)}constructor(t,n,e){super(),this.firstElementChild=null,this.lastElementChild=null,this.childElementCount=0,this.attributes=[],this.namespaceURI=t,this.prefix=n,this.localName=e,this.tagName=null===n?e:`${n}:${e}`}hasAttributes(){return this.attributes.length>0}getAttribute(t){S(arguments,1);const n=go(t=String(t),this);return null===n?null:n.value}getAttributeNS(t,n){S(arguments,2);const e=wo(t=ft(t),n=String(n),this);return null===e?null:e.value}setAttribute(t,n){S(arguments,2),t=String(t),n=String(n),jr(t)||A("The qualified name does not match the Name production");const e=go(t,this);if(null===e){const e=new(u().Attr)(null,null,t,n,this);return e.ownerDocument=this.ownerDocument,void wt(e,this)}gt(e,n)}setAttributeNS(t,n,e){S(arguments,3),t=ft(t),n=String(n),e=String(e);const{namespace:r,prefix:o,localName:i}=At(t,n);!function(t,n,e,r,o){const i=wo(o,n,t);if(null===i){const i=new(u().Attr)(o,r,n,e,t);return i.ownerDocument=t.ownerDocument,void wt(i,t)}gt(i,e)}(this,i,e,o,r)}removeAttribute(t){S(arguments,1),bo(t=String(t),this)}removeAttributeNS(t,n){S(arguments,2),function(t,n,e){const r=wo(t,n,e);null!==r&&yt(r)}(t=ft(t),n=String(n),this)}toggleAttribute(t,n){jr(t)||A("The qualified name does not match the Name production");if(null===go(t,this)){if(void 0===n||!0===n){const n=new(u().Attr)(null,null,t,"",this);return n.ownerDocument=this.ownerDocument,wt(n,this),!0}return!1}return void 0!==n&&!1!==n||(bo(t,this),!1)}hasAttribute(t){return S(arguments,1),null!==go(t=String(t),this)}hasAttributeNS(t,n){return S(arguments,2),null!==wo(t=ft(t),n=String(n),this)}getAttributeNode(t){return S(arguments,1),go(t=String(t),this)}getAttributeNodeNS(t,n){return S(arguments,2),wo(t=ft(t),n=String(n),this)}setAttributeNode(t){return S(arguments,1),yo(t=at(t,Attr),this)}setAttributeNodeNS(t){return S(arguments,1),yo(t=at(t,Attr),this)}removeAttributeNode(t){return S(arguments,1),t=at(t,Attr),this.attributes.indexOf(t)<0&&R("the specified attribute does not exist"),yt(t),t}getElementsByTagName(t){return S(arguments,1),v(t=String(t),this)}getElementsByTagNameNS(t,n){return S(arguments,2),x(t=ft(t),n=String(n),this)}C(t){const n=po(t,this.localName,this.namespaceURI,this.prefix);for(const e of this.attributes){const r=e.C(t);n.setAttributeNode(r)}return n}get innerHTML(){return ao(this,!0)}get outerHTML(){return ao(this,!0,!0)}}function po(t,n,e,r=null){let o=null;return o=new(u().Element)(e,r,n),o.ownerDocument=t,o}function go(t,n){return n.attributes.find((n=>n.name===t))||null}function wo(t,n,e){return""===t&&(t=null),e.attributes.find((e=>e.namespaceURI===t&&e.localName===n))||null}function yo(t,n){null!==t.ownerElement&&t.ownerElement!==n&&function(t){throw C("InUseAttributeError",t)}("attribute is in use by another element");const e=wo(t.namespaceURI,t.localName,n);return e===t?t:(null!==e?function(t,n){const e=t.ownerElement;pt(t,e,t.value,n.value),e.attributes.splice(e.attributes.indexOf(t),1,n),n.ownerElement=e,t.ownerElement=null}(e,t):wt(t,n),e)}function bo(t,n){const e=go(t,n);return null!==e&&yt(e),e}function vo(t,n,e){const{namespace:r,prefix:o,localName:i}=At(n,e);return po(t,i,r,o)}class DOMImplementation{constructor(t){this.Y=t}createDocumentType(t,n,e){S(arguments,3),t=String(t),n=String(n),e=String(e),$t(t);const r=new(u(this.Y).DocumentType)(t,n,e);return r.ownerDocument=this.Y,r}createDocument(t,n,e=null){S(arguments,2),t=ft(t),n=lt(n),e=ht(e,DocumentType);const r=new(u(this.Y).XMLDocument);let o=null;return""!==n&&(o=vo(r,t,n)),e&&r.appendChild(e),o&&r.appendChild(o),r}createHTMLDocument(t){t=ft(t);const n=u(this.Y),e=new n.Document,r=new n.DocumentType("html");r.ownerDocument=e,e.appendChild(r);const o=po(e,"html",Et);e.appendChild(o);const i=po(e,"head",Et);if(o.appendChild(i),null!==t){const n=po(e,"title",Et);i.appendChild(n),n.appendChild(e.createTextNode(t))}return o.appendChild(po(e,"body",Et)),e}}class Document extends Node{get nodeType(){return 9}get nodeName(){return"#document"}get nodeValue(){return null}set nodeValue(t){}get textContent(){return null}set textContent(t){}lookupPrefix(t){return S(arguments,1),null!==this.documentElement?this.documentElement.lookupPrefix(t):null}lookupNamespaceURI(t){return S(arguments,1),null===this.documentElement?null:this.documentElement.lookupNamespaceURI(t)}get children(){return V(this)}prepend(...t){Z(this,t)}append(...t){tt(this,t)}replaceChildren(...t){nt(this,t)}constructor(){super(),this.firstElementChild=null,this.lastElementChild=null,this.childElementCount=0,this.implementation=new DOMImplementation(this),this.doctype=null,this.documentElement=null}getElementsByTagName(t){return S(arguments,1),v(t=String(t),this)}getElementsByTagNameNS(t,n){return S(arguments,2),x(t=ft(t),n=String(n),this)}createElement(t){S(arguments,1),jr(t=String(t))||A("The local name is not a valid Name");return po(this,t,null,null)}createElementNS(t,n){return S(arguments,2),vo(this,t=ft(t),n=String(n))}createDocumentFragment(){const t=new(u().DocumentFragment);return t.ownerDocument=this,t}createTextNode(t){S(arguments,1),t=String(t);const n=new(u().Text)(t);return n.ownerDocument=this,n}createCDATASection(t){S(arguments,1),(t=String(t)).indexOf("]]>")>=0&&A('Data must not contain the string "]]>"');const n=new(u().CDATASection)(t);return n.ownerDocument=this,n}createComment(t){S(arguments,1),t=String(t);const n=new(u().Comment)(t);return n.ownerDocument=this,n}createProcessingInstruction(t,n){S(arguments,2),t=String(t),n=String(n),jr(t)||A("The target is not a valid Name"),n.indexOf("?>")>=0&&A('Data must not contain the string "?>"');const e=new(u().ProcessingInstruction)(t,n);return e.ownerDocument=this,e}importNode(t,n=!1){return S(arguments,1),l(t=at(t,Node),9)&&P("importing a Document node is not supported"),N(t,n,this)}adoptNode(t){return S(arguments,1),l(t=at(t,Node),9)&&P("adopting a Document node is not supported"),Q(t,this),t}createAttribute(t){S(arguments,1),jr(t=String(t))||A("The local name is not a valid Name");const n=new(u().Attr)(null,null,t,"",null);return n.ownerDocument=this,n}createAttributeNS(t,n){S(arguments,2),t=ft(t),n=String(n);const{namespace:e,prefix:r,localName:o}=At(t,n),i=new(u().Attr)(e,r,o,"",null);return i.ownerDocument=this,i}createRange(){const t=new(u().Range);return t.startContainer=this,t.startOffset=0,t.endContainer=this,t.endOffset=0,t}C(t){return new(u().Document)}}class DocumentFragment extends Node{get nodeType(){return 11}get nodeName(){return"#document-fragment"}get nodeValue(){return null}set nodeValue(t){}get textContent(){return K(this)}set textContent(t){G(this,t=ct(t))}lookupPrefix(t){return S(arguments,1),null}lookupNamespaceURI(t){return S(arguments,1),null}get children(){return V(this)}prepend(...t){Z(this,t)}append(...t){tt(this,t)}replaceChildren(...t){nt(this,t)}constructor(){super(),this.firstElementChild=null,this.lastElementChild=null,this.childElementCount=0;const t=u();this.ownerDocument=t.document}C(t){const n=new(u().DocumentFragment);return n.ownerDocument=t,n}}class ProcessingInstruction extends CharacterData{get nodeType(){return 7}get nodeName(){return this.target}constructor(t,n){super(n),this.target=t}C(t){const n=new(u().ProcessingInstruction)(this.target,this.data);return n.ownerDocument=t,n}}function xo(t,n){if(t.collapsed)return;const e=p(t.startContainer),r=p(t.endContainer);let o=0;for(;o<e.length&&o<r.length&&e[o]===r[o];)++o;const i=t.endContainer.childNodes[t.endOffset]||null;for(let o=t.startContainer.childNodes[t.startOffset]||null;o&&o!==i&&o!==r[e.length];o=o.nextSibling)n(o);for(let t=e.length-1;t>=o;--t)for(let o=e[t].nextSibling;o&&o!==i&&o!==r[t];o=o.nextSibling)n(o);for(let t=o;t<r.length;++t)for(let e=r[t].firstChild;e&&e!==i&&e!==r[t+1];e=e.nextSibling)n(e)}function No(t,n){const e=g(t.startContainer),r=e.createDocumentFragment();if(t.collapsed)return r;const o=t.startContainer,i=t.startOffset,s=t.endContainer,u=t.endOffset;if(o===s&&a(o)){const t=o.cloneNode();return t.data=o.substringData(i,u-i),X(t,r),n||o.replaceData(i,u-i,""),r}const c=p(t.startContainer),h=p(t.endContainer);let f=0;for(;f<c.length&&f<h.length&&c[f]===h[f];)++f;const d=f===c.length,y=f===h.length;let b=null;d||(b=c[f]);let v=null;y||(v=h[f]);const x=[],N=b?b.nextSibling:o.childNodes[i],S=v||s.childNodes[u]||null;for(var T=N;T&&T!==S;T=T.nextSibling)l(T,10)&&D(n?"Can not clone a doctype using cloneContents":"Can not extract a doctype using extractContents"),x.push(T);let E,C;if(d||n)E=o,C=i;else{const t=c[f];E=t.parentNode,C=1+w(t)}if(null!==b&&a(b)){const t=b.cloneNode();t.data=b.substringData(i,b.length-i),X(t,r),n||b.replaceData(i,b.length-i,"")}else if(null!==b){const t=b.cloneNode();X(t,r);const s=e.createRange();s.setStart(o,i),s.setEnd(b,m(b));const u=No(s,n);s.detach(),X(u,t)}if(x.forEach((t=>{if(n){X(t.cloneNode(!0),r)}else X(t,r)})),v&&a(v)){const t=v.cloneNode();t.data=v.substringData(0,u),X(t,r),n||v.replaceData(0,u,"")}else if(null!==v){const t=v.cloneNode();X(t,r);const o=e.createRange();o.setStart(v,0),o.setEnd(s,u);const i=No(o,n);o.detach(),X(i,t)}return n||(t.setStart(E,C),t.collapse(!0)),r}class Range{get collapsed(){return(t=this).startContainer===t.endContainer&&t.startOffset===t.endOffset;var t}constructor(){const t=u();this.startContainer=t.document,this.startOffset=0,this.endContainer=t.document,this.endOffset=0,t.addRange(this)}get commonAncestorContainer(){const t=p(this.startContainer),n=p(this.endContainer);let e=t[0],r=0;for(;r<t.length&&r<n.length&&t[r]===n[r];)e=t[r],++r;return e}setStart(t,n){S(arguments,2),t=at(t,Node),n=ut(n),l(t,10)&&I("Can not set a range under a doctype node"),n>m(t)&&$("Can not set a range past the end of the node");Do(this)===y(t)&&Co(t,n,this.endContainer,this.endOffset)!==Eo||(this.endContainer=t,this.endOffset=n),this.startContainer=t,this.startOffset=n}setEnd(t,n){S(arguments,2),t=at(t,Node),n=ut(n),l(t,10)&&I("Can not set a range under a doctype node"),n>m(t)&&$("Can not set a range past the end of the node");Do(this)===y(t)&&Co(t,n,this.startContainer,this.startOffset)!==So||(this.startContainer=t,this.startOffset=n),this.endContainer=t,this.endOffset=n}setStartBefore(t){S(arguments,1);const n=(t=at(t,Node)).parentNode;if(null===n)return I("Can not set range before node without a parent");this.setStart(n,w(t))}setStartAfter(t){S(arguments,1);const n=(t=at(t,Node)).parentNode;if(null===n)return I("Can not set range before node without a parent");this.setStart(n,w(t)+1)}setEndBefore(t){S(arguments,1);const n=(t=at(t,Node)).parentNode;if(null===n)return I("Can not set range before node without a parent");this.setEnd(n,w(t))}setEndAfter(t){S(arguments,1);const n=(t=at(t,Node)).parentNode;if(null===n)return I("Can not set range before node without a parent");this.setEnd(n,w(t)+1)}collapse(t=!1){t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset)}selectNode(t){S(arguments,1);let n=(t=at(t,Node)).parentNode;if(null===n)return I("Can not select node with null parent");const e=w(t);this.startContainer=n,this.startOffset=e,this.endContainer=n,this.endOffset=e+1}selectNodeContents(t){S(arguments,1),l(t=at(t,Node),10)&&I("Can not place range inside a doctype node");const n=m(t);this.startContainer=t,this.startOffset=0,this.endContainer=t,this.endOffset=n}compareBoundaryPoints(t,n){switch(S(arguments,2),n=at(n,Range),t!==Range.START_TO_START&&t!==Range.START_TO_END&&t!==Range.END_TO_END&&t!==Range.END_TO_START&&P("Unsupported comparison type"),Do(this)!==Do(n)&&L("Can not compare positions of ranges in different trees"),t){case Range.START_TO_START:return Co(this.startContainer,this.startOffset,n.startContainer,n.startOffset);case Range.START_TO_END:return Co(this.endContainer,this.endOffset,n.startContainer,n.startOffset);case Range.END_TO_END:return Co(this.endContainer,this.endOffset,n.endContainer,n.endOffset);default:return Co(this.startContainer,this.startOffset,n.endContainer,n.endOffset)}}deleteContents(){if(this.collapsed)return;const t=this.startContainer,n=this.startOffset,e=this.endContainer,r=this.endOffset;if(t===e&&a(t))return void t.replaceData(n,r-n,"");const o=[];let i,s;if(xo(this,(t=>{o.push(t)})),t.contains(e))i=t,s=n;else{let n=t;for(;null!==n.parentNode&&!n.parentNode.contains(e);)n=n.parentNode;i=n.parentNode,s=1+w(n)}a(t)&&t.replaceData(n,t.length-n,""),o.forEach((t=>{H(t)})),a(e)&&e.replaceData(0,r,""),this.setStart(i,s),this.collapse(!0)}extractContents(){return No(this,!1)}cloneContents(){return No(this,!0)}insertNode(t){S(arguments,1),st(t=at(t,Node),this)}surroundContents(t){S(arguments,1),t=at(t,Node);(h(this.startContainer)?this.startContainer.parentNode:this.startContainer)!==(h(this.endContainer)?this.endContainer.parentNode:this.endContainer)&&k("Can not use surroundContents on a range that has partially selected a non-Text node"),l(t,9,10,11)&&I("Can not use Document, DocumentType, or DocumentFragment as a parent node in surroundContents");const n=No(this,!1);t.firstChild&&j(null,t),st(t,this),X(n,t),this.selectNode(t)}cloneRange(){const t=new(u().Range);return t.startContainer=this.startContainer,t.startOffset=this.startOffset,t.endContainer=this.endContainer,t.endOffset=this.endOffset,t}detach(){u().removeRange(this)}isPointInRange(t,n){return S(arguments,2),t=at(t,Node),n=ut(n),y(t)===Do(this)&&(l(t,10)&&I("Point can not be under a doctype"),n>m(t)&&$("Offset should not be past the end of node"),Co(t,n,this.startContainer,this.startOffset)!==So&&Co(t,n,this.endContainer,this.endOffset)!==Eo)}comparePoint(t,n){return S(arguments,2),t=at(t,Node),n=ut(n),y(t)!==Do(this)&&L("Can not compare point to range in different trees"),l(t,10)&&I("Point can not be under a doctype"),n>m(t)&&$("Offset should not be past the end of node"),Co(t,n,this.startContainer,this.startOffset)===So?-1:Co(t,n,this.endContainer,this.endOffset)===Eo?1:0}intersectsNode(t){if(S(arguments,1),y(t=at(t,Node))!==Do(this))return!1;const n=t.parentNode;if(null===n)return!0;const e=w(t);return Co(n,e,this.endContainer,this.endOffset)===So&&Co(n,e+1,this.startContainer,this.startOffset)===Eo}toString(){let t=[];const n=this.startContainer;if(h(n)){if(this.startContainer===this.endContainer)return n.substringData(this.startOffset,this.endOffset-this.startOffset);t.push(n.substringData(this.startOffset,n.length-this.startOffset))}xo(this,(n=>{b(n,(n=>{h(n)&&t.push(n.data)}))}));const e=this.endContainer;return h(e)&&t.push(e.substringData(0,this.endOffset)),t.join("")}}Range.START_TO_START=0,Range.START_TO_END=1,Range.END_TO_END=2,Range.END_TO_START=3;const So=-1,To=0,Eo=1;function Co(t,n,e,r){if(t!==e){const o=p(t),i=p(e);for(;o[0]&&i[0]&&o[0]===i[0];)o.shift(),i.shift();o.length&&(n=w(o[0])+.5),i.length&&(r=w(i[0])+.5)}return n===r?To:n<r?So:Eo}function Do(t){return y(t.startContainer)}class XMLDocument extends Document{C(t){return new(u().XMLDocument)}}const $o=new Document;s.document=$o,s.Attr=Attr,s.CDATASection=CDATASection,s.Comment=Nt,s.Document=Document,s.DocumentFragment=DocumentFragment,s.DocumentType=DocumentType,s.DOMImplementation=DOMImplementation,s.Element=Element,s.ProcessingInstruction=ProcessingInstruction,s.Range=Range,s.Text=Text,s.XMLDocument=XMLDocument,t.Attr=Attr,t.CDATASection=CDATASection,t.CharacterData=CharacterData,t.Comment=Nt,t.DOMException=E,t.DOMImplementation=DOMImplementation,t.DOMParser=class{constructor(){}parseFromString(t,n){switch(n){case"text/html":throw new Error("HTML parsing is not implemented");case"text/xml":case"application/xml":case"application/xhtml+xml":case"image/svg+xml":try{return uo(t)}catch(t){const n=new Document,e=n.createElementNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","parsererror");return e.appendChild(n.createTextNode(`${t}`)),n.appendChild(e),n}default:throw new TypeError(`The type "${n}" is not a valid value in the SupportedType enumeration.`)}}},t.Document=Document,t.DocumentFragment=DocumentFragment,t.DocumentType=DocumentType,t.Element=Element,t.MutationObserver=class{constructor(t){this.u=[],this.m=[],this.t=[],S(arguments,1),t=at(t,Function),this.v=t}observe(t,n){if(S(arguments,2),t=at(t,Node),n.childList=!!n.childList,n.subtree=!!n.subtree,void 0!==n.attributeOldValue&&void 0===n.attributes&&(n.attributes=!0),void 0!==n.characterDataOldValue&&void 0===n.characterData&&(n.characterData=!0),!(n.childList||n.attributes||n.characterData))throw new TypeError('The options object must set at least one of "attributes", "characterData", or "childList" to true.');if(n.attributeOldValue&&!n.attributes)throw new TypeError('The options object may only set "attributeOldValue" to true when "attributes" is true or not present.');if(n.characterDataOldValue&&!n.characterData)throw new TypeError('The options object may only set "characterDataOldValue" to true when "characterData" is true or not present.');t.o.register(this,n)}disconnect(){this.u.forEach((t=>t.o.removeForObserver(this))),this.u.length=0,this.m.length=0}takeRecords(){const t=this.m.concat();return this.m.length=0,t}},t.MutationRecord=O,t.Node=Node,t.ProcessingInstruction=ProcessingInstruction,t.Range=Range,t.StaticRange=class{constructor(t){l(t.startContainer,10,2)&&I("StaticRange startContainer must not be a doctype or attribute node"),l(t.endContainer,10,2)&&I("StaticRange endContainer must not be a doctype or attribute node"),this.startContainer=t.startContainer,this.startOffset=t.startOffset,this.endContainer=t.endContainer,this.endOffset=t.endOffset,this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset}},t.Text=Text,t.XMLDocument=XMLDocument,t.XMLSerializer=class{constructor(){}serializeToString(t){const n=[];return ho(t=at(t,Node),!1,n),n.join("")}},t.document=$o,t.parseXmlDocument=uo,t.parseXmlFragment=function(t,n={}){const e=(new Document).createDocumentFragment();return so(t,Ur,n.resolveNamespacePrefix?no.default(n.resolveNamespacePrefix):eo,e,n),e},t.serializeToWellFormedString=function(t){const n=[];return ho(t=at(t,Node),!0,n),n.join("")},t.unsafeAppendAttribute=function(t,n){wt(t,n)},t.unsafeCreateAttribute=St,t.unsafeCreateElement=Tt,Object.defineProperty(t,"j",{value:!0})}));
//# sourceMappingURL=slimdom.umd.cjs.map
