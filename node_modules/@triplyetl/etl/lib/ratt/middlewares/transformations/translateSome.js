import { Vocabulary } from "@triplyetl/vocabularies";
import { addMwCallSiteToError } from "../../../utils/index.js";
import { add } from "./custom/add.js";
import { vocabularyToTable } from "./translateAll.js";
/**
 * Translates some strings, according to the specified translation table, to
 * other strings.  Strings that are not translated according to the
 * translation table are copied over as-is.
 *
 * @remarks
 * Source data often contains some strings that are correct and some that are
 * incorrect.  For example, if source data contains a key with city names,
 * some of the names may be misspelled.  In such cases, `translateSome()` can
 * be used to translate the incorrect strings into correct ones.
 *
 * A `translateSome()` transformation is often performed directly before a
 * `translateAll()` transformation.  The former ensures that all string values
 * are correct (e.g. fixing typo's in city names); the latter ensures that
 * all strings are mapped onto IRIs (e.g. city names mapped onto
 * city-denoting IRIs).
 *
 * @param args.content - A key that contains a string value.
 *
 * @param args.table - A translation table that specifies translations from
 * strings to strings.
 *
 * @param args.key - A new key where the translated strings are stored.
 *
 * @example
 * The following example fixes an encoding issue that occurs in the source
 * data:
 *
 * ```ts
 * transform.translateSome({
 *   content: 'name',
 *   table: {
 *     'Frysl��n': 'Fryslân',
 *     // Other entries for typographic fixes go here.
 *     ...,
 *   },
 *   key: '_name',
 * }),
 * ```
 */
export default function (args) {
    return addMwCallSiteToError(add({
        value: (context) => translateSome({
            content: context.getString(args.content),
            table: args.table,
            context,
        }),
        key: args.key,
    }), { sourceFuncName: "_translateSome" });
}
function translateSome(args) {
    const table = typeof args.table === "string"
        ? args.context.getTable(args.table)
        : Vocabulary.isVocabulary(args.table)
            ? vocabularyToTable(args.table)
            : args.table;
    if (Object.keys(table).includes(args.content)) {
        return table[args.content];
    }
    else {
        return args.content;
    }
}
//# sourceMappingURL=translateSome.js.map