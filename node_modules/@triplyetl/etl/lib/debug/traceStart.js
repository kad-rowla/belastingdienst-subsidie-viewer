import { cloneDeep } from "lodash-es";
import { addMwCallSiteToError } from "../utils/index.js";
function createTraceInfo(ctx) {
    return {
        fromMwIndex: [...ctx.app["currentMwIndices"]],
        recordId: ctx.recordId,
        record: cloneDeep(ctx.record),
        quads: ctx.store.toNquadsString(),
    };
}
// TODO @DocumentationTeam: add TS doc comment here
export default function traceStart() {
    return addMwCallSiteToError(async function _traceStart(ctx, next) {
        if (ctx["traceInfo"])
            throw new Error("Trace info already exist. Did you forget to add a traceEnd() somewhere?");
        ctx["traceInfo"] = createTraceInfo(ctx);
        return next();
    }, { sourceFuncName: "_traceStart" });
}
export function setTraceErrorInfo(ctx) {
    ctx["traceError"] = createTraceInfo(ctx);
}
//# sourceMappingURL=traceStart.js.map