import { fill } from "lodash-es";
import { Destination, Etl, fromJson, Iri, toRdf } from "../generic/index.js";
import { iri, triple } from "../ratt/index.js";
export default async function (): Promise<Etl> {
  const app = new Etl({
    prefixes: { bla: Iri("https://sdf") },
    defaultGraph: "https://default.com/",
  });

  app.use(
    fromJson(
      fill(new Array(700), { a: "a:a", b: "b:b", c: "c:c" }).map((r, i) => {
        r.a = r.a + i;
        return { ...r };
      }),
    ),
  );

  /**
   * Take fields from the etl record, and store as quads.
   */
  app.use(triple(iri("a"), iri("b"), iri("c")));

  app.use(toRdf(Destination.file("./data/test-file.nq")));

  return app;
}
