prefix sh: <http://www.w3.org/ns/shacl#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>


prefix ex: <https://data.triply.cc/example/>
prefix id: <https://data.triply.cc/example/id/>
prefix shp: <https://data.test.cc/example/shp/>
prefix rule: <https://data.triply.cc/example/rule/>

shp: {


shp:BShape
  a sh:NodeShape ;
  sh:order 2;
  sh:rule rule:B, rule:connect;
  sh:targetClass ex:B .

shp:AShape
  a sh:NodeShape ;
  sh:order 1;
  sh:rule rule:connect;
  sh:targetClass ex:A .

rule:B
  a sh:SPARQLRule;
    sh:order 1;
  sh:construct '''
  prefix ex: <https://data.triply.cc/example/>
  construct {
    $this ex:connectedTo ?connected 
  } where {
    ?connected a ex:A
  }
'''.

rule:connect
  a sh:SPARQLRule;
    sh:order 2 ;
    sh:construct '''
  prefix ex: <https://data.triply.cc/example/>
  construct {
    $this ex:isConnected ?bound
  } where {
    $this a ?type .
    optional {
      $this ex:connectedTo ?connected
    }
    bind(if(bound(?connected),true, false) as ?bound)
  }
  '''.

}