import { existsSync, readFileSync, writeFileSync } from "fs";
import path from "path";

let tokenFile: string;
if (process.env.ENV !== undefined) {
  tokenFile = path.join(process.cwd(), `/.env-${process.env.ENV.toLowerCase()}`);
} else {
  tokenFile = path.join(process.cwd(), "/.env");
}
const packageJsonFile = path.join(process.cwd(), "/.package.json");

export function tokenFileExists(): boolean {
  return existsSync(tokenFile);
}

export function writeToTokenFile(content: string): void {
  writeFileSync(tokenFile, content);
}

export function packageJson(key?: string): undefined | { [key: string]: string | { [key: string]: string } } {
  if (existsSync(packageJsonFile)) {
    const content = JSON.parse(readFileSync(packageJsonFile, { encoding: "utf8" }));
    if (key !== undefined) return content[key];
    else return content;
  } else {
    return undefined;
  }
}
